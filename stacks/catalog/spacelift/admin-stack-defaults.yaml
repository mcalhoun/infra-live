components:
  terraform:
    spacelift/admin-stack/defaults:
      metadata:
        type: abstract
        component: spacelift/admin-stack
      settings:
        spacelift:
          administrative: true
          autodeploy: true
          before_apply:
            - spacelift-configure-paths
          before_init:
            - spacelift-configure-paths
            - spacelift-write-vars
            - spacelift-tf-workspace
          before_plan:
            - spacelift-configure-paths
          labels:
            - admin
            - folder:admin
          depends_on:
            - infrastructure-root-admin
      vars:
        administrative: true
        branch: main
        component_root: components/terraform
        enabled: true
        repository: infra-live
        terraform_version: "1.3.9"
        worker_pool_id: 01H0NQR7V7XQCMH6AZBW69J9MA
        runner_image: 552533042161.dkr.ecr.us-east-2.amazonaws.com/mcalhoun/infra-live:latest

